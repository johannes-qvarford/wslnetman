import { VerticalBox, HorizontalBox, ScrollView, Button } from "std-widgets.slint";
import { DockerNetwork, DockerContainer } from "../types.slint";

export component DockerNetworkDetailModal inherits Rectangle {
    in property <DockerNetwork> network-detail;
    in property <[DockerContainer]> containers: [];
    in-out property <bool> show-modal: false;
    
    callback copy-to-clipboard(string);
    
    width: 100%;
    height: 100%;
    background: #00000080; // Semi-transparent backdrop
    z: 1000; // Ensure it's on top
    
    // Modal backdrop - catches clicks but doesn't close modal
    TouchArea {
        clicked => {
            // Do nothing - prevent modal from closing on backdrop click
        }
    }
    
    // Centered modal content
    Rectangle {
        width: 750px;
        height: root.height - 80px;
        x: (parent.width - self.width) / 2;
        y: (parent.height - self.height) / 2;
        background: #2d2d2d;
        border-width: 2px;
        border-color: #555555;
        border-radius: 8px;
        drop-shadow-blur: 15px;
        drop-shadow-color: #000000aa;
        
        VerticalBox {
            padding: 20px;
            spacing: 15px;
            
            // Header with close button
            HorizontalBox {
                Text {
                    text: "Docker Network Details";
                    font-size: 18px;
                    font-weight: 700;
                    color: #ffffff;
                    horizontal-alignment: left;
                }
                Button {
                    text: "Ã—";
                    width: 32px;
                    height: 32px;
                    clicked => {
                        show-modal = false;
                    }
                }
            }
            
            Rectangle {
                height: 2px;
                background: #555555;
            }
            
            ScrollView {
                VerticalBox {
                    spacing: 15px;
                    
                    // Network Information Section
                    VerticalBox {
                        spacing: 10px;
                        
                        Text {
                            text: "Network Information";
                            font-size: 16px;
                            font-weight: 600;
                            color: #ffffff;
                        }
                        
                        HorizontalBox {
                            Text { text: "Name:"; width: 120px; font-weight: 500; color: #cccccc; }
                            Button {
                                text: network-detail.name;
                                width: 200px;
                                height: 26px;
                                clicked => {
                                    copy-to-clipboard(network-detail.name);
                                }
                            }
                        }
                        
                        HorizontalBox {
                            Text { text: "Driver:"; width: 120px; font-weight: 500; color: #cccccc; }
                            Text { 
                                text: network-detail.driver;
                                font-family: "monospace";
                                color: #ffffff;
                            }
                        }
                        
                        HorizontalBox {
                            Text { text: "Scope:"; width: 120px; font-weight: 500; color: #cccccc; }
                            Text { 
                                text: network-detail.scope;
                                font-family: "monospace";
                                color: #ffffff;
                            }
                        }
                        
                        HorizontalBox {
                            Text { text: "Subnet:"; width: 120px; font-weight: 500; color: #cccccc; }
                            if network-detail.subnet != "" : Button {
                                text: network-detail.subnet;
                                width: 180px;
                                height: 26px;
                                clicked => {
                                    copy-to-clipboard(network-detail.subnet);
                                }
                            }
                            if network-detail.subnet == "" : Text {
                                text: "N/A";
                                color: #888888;
                            }
                        }
                    }
                    
                    Rectangle {
                        height: 1px;
                        background: #555555;
                    }
                    
                    // Containers Section
                    VerticalBox {
                        spacing: 10px;
                        
                        Text {
                            text: "Connected Containers";
                            font-size: 16px;
                            font-weight: 600;
                            color: #ffffff;
                        }
                        
                        if containers.length > 0 : VerticalBox {
                            spacing: 6px;
                            
                            // Container headers
                            HorizontalBox {
                                Text { text: "Container Name"; width: 140px; font-weight: 600; font-size: 12px; color: #cccccc; }
                                Text { text: "Image"; width: 120px; font-weight: 600; font-size: 12px; color: #cccccc; }
                                Text { text: "Status"; width: 100px; font-weight: 600; font-size: 12px; color: #cccccc; }
                                Text { text: "Ports"; width: 120px; font-weight: 600; font-size: 12px; color: #cccccc; }
                                Text { text: "Container ID"; width: 100px; font-weight: 600; font-size: 12px; color: #cccccc; }
                            }
                            
                            Rectangle {
                                height: 1px;
                                background: #555555;
                            }
                            
                            for container in containers : HorizontalBox {
                                Button {
                                    text: container.name;
                                    width: 140px;
                                    height: 26px;
                                    clicked => {
                                        copy-to-clipboard(container.name);
                                    }
                                }
                                Text { 
                                    text: container.image; 
                                    width: 120px; 
                                    font-family: "monospace";
                                    font-size: 11px;
                                    color: #ffffff;
                                }
                                Text { 
                                    text: container.status; 
                                    width: 100px; 
                                    font-family: "monospace";
                                    font-size: 11px;
                                    color: #ffffff;
                                }
                                if container.ports != "" : Button {
                                    text: container.ports;
                                    width: 120px;
                                    height: 26px;
                                    clicked => {
                                        copy-to-clipboard(container.ports);
                                    }
                                }
                                if container.ports == "" : Text {
                                    text: "N/A";
                                    width: 120px;
                                    color: #888888;
                                    font-size: 11px;
                                }
                                Button {
                                    text: container.id;
                                    width: 100px;
                                    height: 26px;
                                    clicked => {
                                        copy-to-clipboard(container.id);
                                    }
                                }
                            }
                        }
                        
                        if containers.length == 0 : Text {
                            text: "No containers connected to this network";
                            color: #888888;
                        }
                    }
                }
            }
        }
    }
}